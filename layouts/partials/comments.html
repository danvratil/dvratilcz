<!--
Original code by Carl Schwan (https://carlschwan.eu/2020/12/29/adding-comments-to-your-static-blog-with-mastodon/)
//-->
{{ with .Params.comments }}
<section id="comments" class="post-comments">
  <h1>Comments</h1>
  <p>With an account on the Fediverse or Mastodon, you can respond to this <a href="https://{{ .host }}/@{{ .username }}/{{ .id }}">post</a>. Since Mastodon is decentralized, you can use your existing account hosted by another Mastodon server or compatible platform if you don't have an account on this one. Known non-private replies are displayed below.</p>
  <p>Learn how this is implemented <a class="link" href="https://carlschwan.eu/2020/12/29/adding-comments-to-your-static-blog-with-mastodon/">here.</a></p>

  <p id="mastodon-comments-list">
    <button id="load-comment" data-host="{{ .host }}" data-username="{{ .username }}" data-post-id="{{ .id }}">Load comments</button></p>
  <div id="comments-wrapper">
    <noscript><p>Loading comments relies on JavaScript. Try enabling JavaScript and reloading, or visit <a href="https://{{ .host }}/@{{ .username }}/{{ .id }}">the original post</a> on Mastodon.</p></noscript>
  </div>
  <noscript>You need JavaScript to view the comments.</noscript>
  {{ with resources.Get "js/purify.min.js" | resources.Fingerprint }}
    <script src="{{ .RelPermalink }}" type="text/javascript"></script>
  {{ end }}
  {{ with resources.Get "js/mastodon-comments.js" | resources.Minify | resources.Fingerprint }}
    <script src="{{ .RelPermalink }}" type="text/javascript"></script>
  {{ end }}
</section>
{{ end }}